<html>

<head>
    <style>
        #label {
            float: left;
            padding-right: 5px;
            width: 105px;
            /* text-align: center; */
        }
    </style>

</head>

<body>
    <%- partial('../partial/sidemenu.ejs') %>
        <div class="content admin w-100">
            <h5 class="main-heading1">活動管理<span class="highlight">系統</span></h5> <!-- Event Management System -->
            <form class="ajax-with-preview" action="/admin/events/create/<%=events.id%>" method="POST"
                data-callback200="location.assign('/admin/events/');" id='file-catcher'>
                <section>
                    <h6 class="main-heading2 mb-0">新增活動/比賽</h6> <!-- Create event/competition -->
                    <div class="container-fluid">
                        <div class="row">
                            <div class="col-12 col-lg-6 form-group d-flex required">
                                <label class="flex-shrink-0 col-form-label" id="label">開始日期</label> <!-- Start Date -->
                                <input class="form-control" type="datetime-local" name="Events[start]" id="startDate"
                                    required>
                            </div>
                            <div class="col-12 col-lg-6 form-group d-flex required">
                                <label class="flex-shrink-0 col-form-label" id="label">完結日期</label> <!-- End Date -->
                                <input class="form-control" type="datetime-local" name="Events[end]" id="endDate"
                                    required>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12 col-lg-6 form-group d-flex">
                                <label class="flex-shrink-0 col-form-label">不顯示時間</label>
                                <input class="form-control" type="checkbox" name="Events[nodate]" id="nodate"
                                    onclick="myFunction()" value="on">
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12 form-group d-flex required">
                                <label class="flex-shrink-0 col-form-label" id="label">體操類別</label> <!-- Discipline -->
                                <input class="form-control" type="text" name="Events[discipline]" list="cat_list2"
                                    required oninvalid="setCustomValidity('請輸入資料')"
                                    onchange="try{setCustomValidity('')}catch(e){}">
                                <datalist id="cat_list2">
                                    <option value="競技體操">
                                        <!-- Competitive gymnastics -->
                                    <option value="藝術體操">
                                        <!-- Rhythmic gymnastics -->
                                    <option value="彈網">
                                        <!-- Trampoline -->
                                    <option value="健美體操">
                                        <!--  Aerobic gymnastics -->
                                    <option value="技巧體操">
                                        <!--  Acrobatic gymnastics -->
                                    <option value="普及體操">
                                        <!--  Gymnastics for all -->
                                    <option value="跑酷">
                                        <!-- Parkour -->
                                </datalist>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12 form-group d-flex required">
                                <label class="flex-shrink-0 col-form-label" id="label">比賽類別</label>
                                <!-- Competition Category -->
                                <input class="form-control" type="text" name="Events[category]" list="cat_list3"
                                    required oninvalid="setCustomValidity('請輸入資料')"
                                    onchange="try{setCustomValidity('')}catch(e){}">
                                <datalist id="cat_list3">
                                    <option value="國際邀請賽">
                                        <!-- International Invitional -->
                                    <option value="邀請賽">
                                        <!-- Invitional -->
                                    <option value="公開賽">
                                        <!-- Open -->
                                    <option value="分齡賽">
                                        <!-- Age Group -->
                                    <option value="學界賽">
                                        <!-- Academic competition -->
                                </datalist>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12 form-group d-flex required">
                                <label class="flex-shrink-0 col-form-label" id="label">活動名稱</label> <!-- EventName -->
                                <textarea class="form-control" name="Events[title]" placeholder="請輸入活動名稱" required
                                    oninvalid="setCustomValidity('請輸入資料')"
                                    onchange="try{setCustomValidity('')}catch(e){}"></textarea>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-12 form-group d-flex required">
                                <label class="flex-shrink-0 col-form-label" id="label">場地</label>
                                <!-- <p>&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp&nbsp</p> -->
                                <input class="form-control" type="text" name="Events[venue]" id="venue" list="cat_list4"
                                    required oninvalid="setCustomValidity('請輸入資料')"
                                    onchange="try{setCustomValidity('')}catch(e){}">
                                <datalist id="cat_list4">
                                    <option value="">

                                    </option>
                                    <optgroup label="新界">
                                        <option value="蕙荃體育館">蕙荃體育館</option>
                                        <option value="荃灣體育館">荃灣體育館</option>
                                        <option value="馬鞍山體育館">馬鞍山體育館</option>
                                    </optgroup>
                                    <optgroup label="港島">
                                        <option value="港灣道體育館">港灣道體育館</option>
                                        <option value="伊利沙伯體育館">伊利沙伯體育館</option>
                                    </optgroup>
                                    <optgroup label="九龍">
                                        <option value="">--</option>
                                    </optgroup>
                                </datalist>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-12 form-group d-flex">
                                <label class="flex-shrink-0 col-form-label" id="label">備註</label>
                                <textarea class="form-control" name="Events[remarks]"></textarea>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-12 form-group d-flex">
                              <label class="flex-shrink-0 col-form-label" id="label">附件</label>
                              <input type="button" class="btn btn-danger" value="X" onclick="deletefile('getFileName', 'Events[attachmentName]')">
                              <input id="getFileName" style="border:none;" name="Events[attachmentName]"
                                value="<%=events.attachmentName%>" readonly>
                              <input type="file" id="fileName"
                                onchange="handleFile(this.files, 'Events[attachment]', 'fileName', 'getFileName', 'Events[attachmentName]','preview', 'attdata' )" />
                              <div id="preview"></div>
                              <br>
                            </div>
                          </div>
              
                          <div class="row">
                            <div class="col-12 form-group d-flex">
                              <label class="flex-shrink-0 col-form-label" id="label">附件</label>
                              <input type="button" class="btn btn-danger" value="X" onclick="deletefile('getFileName2', 'Events[attachmentName2]')">
                              <input id="getFileName2" style="border:none;" name="Events[attachmentName2]"
                                value="<%=events.attachmentName2%>" readonly>
                              <input type="file" id="fileName2"
                                onchange="handleFile(this.files, 'Events[attachment2]', 'fileName2', 'getFileName2', 'Events[attachmentName2]','preview2' )" />
                              <div id="preview2"></div>
                              <br>
                            </div>
                          </div>
              
                          <div class="row">
                            <div class="col-12 form-group d-flex">
                              <label class="flex-shrink-0 col-form-label" id="label">附件</label>
                              <input type="button" class="btn btn-danger" value="X" onclick="deletefile('getFileName3', 'Events[attachmentName3]')">
                              <input id="getFileName3" style="border:none;" name="Events[attachmentName3]"
                                value="<%=events.attachmentName3%>" readonly>
                              <input type="file" id="fileName3"
                                onchange="handleFile(this.files, 'Events[attachment3]', 'fileName3', 'getFileName3', 'Events[attachmentName3]','preview3' )" />
                              <div id="preview3"></div>
                              <br>
                            </div>
                          </div>
              
                          <div class="row">
                            <div class="col-12 form-group d-flex">
                              <label class="flex-shrink-0 col-form-label" id="label">附件</label>
                              <input type="button" class="btn btn-danger" value="X" onclick="deletefile('getFileName4', 'Events[attachmentName4]')">
                              <input id="getFileName4" style="border:none;" name="Events[attachmentName4]"
                                value="<%=events.attachmentName4%>" readonly>
                              <input type="file" id="fileName4"
                                onchange="handleFile(this.files, 'Events[attachment4]', 'fileName4', 'getFileName4', 'Events[attachmentName4]','preview4' )" />
                              <div id="preview4"></div>
                              <br>
                            </div>
                          </div>
              
                          <div class="row">
                            <div class="col-12 form-group d-flex">
                              <label class="flex-shrink-0 col-form-label" id="label">附件</label>
                              <input type="button" class="btn btn-danger" value="X" onclick="deletefile('getFileName5', 'Events[attachmentName5]')">
                              <input id="getFileName5" style="border:none;" name="Events[attachmentName5]"
                                value="<%=events.attachmentName5%>" readonly>
                              <input type="file" id="fileName5"
                                onchange="handleFile(this.files, 'Events[attachment5]', 'fileName5', 'getFileName5', 'Events[attachmentName5]','preview5' )" />
                              <div id="preview5"></div>
                              <br>
                            </div>
                          </div>
              
                          <div class="row">
                            <div class="col-12 form-group d-flex">
                              <label class="flex-shrink-0 col-form-label" id="label">附件</label>
                              <input type="button" class="btn btn-danger" value="X" onclick="deletefile('getFileName6', 'Events[attachmentName6]')">
                              <input id="getFileName6" style="border:none;" name="Events[attachmentName6]"
                                value="<%=events.attachmentName6%>" readonly>
                              <input type="file" id="fileName6"
                                onchange="handleFile(this.files, 'Events[attachment6]', 'fileName6', 'getFileName6', 'Events[attachmentName6]','preview6' )" />
                              <div id="preview6"></div>
                              <br>
                            </div>
                          </div>
              
                          <div class="row">
                            <div class="col-12 form-group d-flex">
                              <label class="flex-shrink-0 col-form-label" id="label">附件</label>
                              <input type="button" class="btn btn-danger" value="X" onclick="deletefile('getFileName7', 'Events[attachmentName7]')">
                              <input id="getFileName7" style="border:none;" name="Events[attachmentName7]"
                                value="<%=events.attachmentName7%>" readonly>
                              <input type="file" id="fileName7"
                                onchange="handleFile(this.files, 'Events[attachment7]', 'fileName7', 'getFileName7', 'Events[attachmentName7]','preview7' )" />
                              <div id="preview7"></div>
                              <br>
                            </div>
                          </div>
              
                          <div class="row">
                            <div class="col-12 form-group d-flex">
                              <label class="flex-shrink-0 col-form-label" id="label">附件</label>
                              <input type="button" class="btn btn-danger" value="X" onclick="deletefile('getFileName8', 'Events[attachmentName8]')">
                              <input id="getFileName8" style="border:none;" name="Events[attachmentName8]"
                                value="<%=events.attachmentName8%>" readonly>
                              <input type="file" id="fileName8"
                                onchange="handleFile(this.files, 'Events[attachment8]', 'fileName8', 'getFileName8', 'Events[attachmentName8]','preview8' )" />
                              <div id="preview8"></div>
                              <br>
                            </div>
                          </div>
              
                          <div class="row">
                            <div class="col-12 form-group d-flex">
                              <label class="flex-shrink-0 col-form-label" id="label">附件</label>
                              <input type="button" class="btn btn-danger" value="X" onclick="deletefile('getFileName9', 'Events[attachmentName9]')">
                              <input id="getFileName9" style="border:none;" name="Events[attachmentName9]"
                                value="<%=events.attachmentName9%>" readonly>
                              <input type="file" id="fileName9"
                                onchange="handleFile(this.files, 'Events[attachment9]', 'fileName9', 'getFileName9', 'Events[attachmentName9]','preview9' )" />
                              <div id="preview9"></div>
                              <br>
                            </div>
                          </div>
              
                          <div class="row">
                            <div class="col-12 form-group d-flex">
                              <label class="flex-shrink-0 col-form-label" id="label">附件</label>
                              <input type="button" class="btn btn-danger" value="X" onclick="deletefile('getFileName10', 'Events[attachmentName10]')">
                              <input id="getFileName10" style="border:none;" name="Events[attachmentName10]"
                                value="<%=events.attachmentName10%>" readonly>
                              <input type="file" id="fileName10"
                                onchange="handleFile(this.files, 'Events[attachment10]', 'fileName10', 'getFileName10', 'Events[attachmentName10]','preview10' )" />
                              <div id="preview10"></div>
                              <br>
                            </div>
                          </div>


                        <div class="row">
                            <div class="col-12 form-group d-flex">
                                <label class="flex-shrink-0 col-form-label" id="label">網上報名</label>
                                <input
                                    pattern="^(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/)?[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$"
                                    onkeyup="showLinkName()" id="lk" type="text" class="form-control"
                                    name="Events[links]" placeholder="請輸入鏈接"
                                    oninvalid="setCustomValidity('請輸入有效網址，例如www.example.com 或者 https://www.example.com')"
                                    onchange="try{setCustomValidity('')}catch(e){}">
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-12 form-group d-flex">
                                <label class="flex-shrink-0 col-form-label" id="label">鏈接名稱＊</label>
                                <input id="linkNameID" type="text" class="form-control" name="Events[linksName]"
                                    placeholder="請輸入上述報名鏈接的名稱" disabled>
                            </div>
                        </div>

                        <div class="row">
                            <div class="col-12 form-group">
                                <button class="btn btn-primary" type="submit">
                                    新增
                                    <!-- Create -->
                                </button>
                                <label><small><span style="color:red">＊</span>為必需填寫</small></label>
                            </div>
                        </div>
                    </div>
                </section>
            </form>

        </div>

        <script>

            function myFunction() {
                var checkBox = document.getElementById("nodate");
                if (checkBox.checked == true) {
                    document.getElementById('startDate').type = 'date';
                    document.getElementById('endDate').type = 'date';
                } else {
                    document.getElementById('startDate').type = 'datetime-local';
                    document.getElementById('endDate').type = 'datetime-local';
                }
            }

        </script>

        <script>

            function showLinkName() {
                var x = document.getElementById("lk");

                if (x.value != "") {
                    document.getElementById("linkNameID").disabled = false;
                    document.getElementById("linkNameID").required = true;
                } else {
                    document.getElementById("linkNameID").required = false;
                    document.getElementById("linkNameID").value = "";
                    document.getElementById("linkNameID").disabled = true;
                }

            }

        </script>

        <script>

            var startDate = document.getElementById('startDate');
            var endDate = document.getElementById('endDate');

            startDate.addEventListener('change', function () {
                if (startDate.value)
                    endDate.min = startDate.value;
            }, false);
            endDate.addEventListener('change', function () {
                if (endDate.value)
                    startDate.max = endDate.value;
            }, false);


            function handleFile(files, attachment, fileName, getFileName, attachmentName, pre) {

                const file = files[0];

                var preview = document.getElementById(pre);

                var reader = new FileReader();
                reader.onload = function (e) {
                    preview.innerHTML = "";

                    var input = document.createElement('input');
                    input.type = 'hidden';
                    input.name = attachment;
                    input.value = e.target.result;
                    preview.appendChild(input);


                    var input = document.getElementById(fileName);
                    var output = document.getElementById(getFileName);
                    output.name = attachmentName
                    for (var i = 0; i < input.files.length; ++i) {
                        output.value = input.files.item(i).name;
                    }
                }
                reader.readAsDataURL(file);

            }

            function deletefile(getFileName, attachmentName) {
                var output = document.getElementById(getFileName);
                output.name = attachmentName
                output.value = "";

            }


        </script>

</body>

</html>